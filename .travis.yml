dist: xenial
language: bash
addons:
  apt:
    packages:
    - aria2
    - zip
    - unzip
script:
- source ./env.sh
- "${DLR} ${ROOTFS_URL} -o ${ROOTFS_TXZ}"
- "${DLR} ${LNCR_URL} -o ${LNCR_ZIP}"
- 
- unzip ${LNCR_ZIP} ${LNCR_FN}
-
- mkdir rootfs
- sudo tar xf ${ROOTFS_TXZ} -C ./rootfs
- 
- echo "# This file was automatically generated by WSL. To stop automatic generation
  of this file, remove this line." | sudo tee ./rootfs/etc/resolv.conf
- 
- cd rootfs
- sudo tar -zcpf ../rootfs.tar.gz --hard-dereference *
- cd ..
- 
- mkdir out
- mv -f ${LNCR_FN} ./out/
- mv -f rootfs.tar.gz ./out/
- cd out
- zip Clear.zip *
- cd ..
notifications:
  email: false
deploy:
  provider: releases
  api_key: T1qs2k8TMNrO45kpXkO0xg
  file: out/Clear.zip
  on:
    repo: ZVNexus/CLR-WSL
    tags: true
    all_branches: true
  skip_cleanup: true
